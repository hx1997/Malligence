#include <stdio.h>
#include <windows.h>
#include "pe.h"

int runPART(char *file)
{
	int fStatus = 0;
	
	struct pe_file pf;
	memset(&pf, 0, sizeof(pf));
	
    if(!read_pe(file, &pf)) {
    	DWORD DebugSize = pf.NtHeaders.OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_DEBUG].Size;
        int ImageVersion = (pf.NtHeaders.OptionalHeader.MajorImageVersion * 100 + pf.NtHeaders.OptionalHeader.MinorImageVersion) * 1000L;
        DWORD IatRVA = pf.NtHeaders.OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_IMPORT].VirtualAddress;
        DWORD ExportSize = pf.NtHeaders.OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].Size;
        DWORD ResourceSize = pf.NtHeaders.OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_RESOURCE].Size;
        DWORD VirtualSize2 = pf.EPSections[1].Misc.VirtualSize;
        WORD NumberOfSections = pf.NtHeaders.FileHeader.NumberOfSections;
        
        if(DebugSize > 0 && ResourceSize > 545 && IatRVA <= 94208 && NumberOfSections <= 5 && ExportSize > 0 && NumberOfSections > 3)
            fStatus = 0;
        else if(DebugSize <= 0 && ImageVersion <= 4900 && ExportSize <= 71 && ImageVersion <= 520 && VirtualSize2 > 130 && IatRVA <= 24576)
            fStatus = 1;
        else if(DebugSize <= 0 && ImageVersion <= 4900 && ExportSize <= 211 && ResourceSize <= 32272 && NumberOfSections <= 10 && VirtualSize2 <= 5 && ImageVersion <= 3420)
            fStatus = 1;
        else if(DebugSize > 0 && ResourceSize > 598 && VirtualSize2 <= 105028 && VirtualSize2 > 1 && ImageVersion > 5000)
            fStatus = 0;
        else if(IatRVA <= 0 && ImageVersion > 4180 && ResourceSize > 2484)
            fStatus = 0;
        else if(DebugSize <= 0 && NumberOfSections <= 1 && ResourceSize > 501)
            fStatus = 0;
        else if(DebugSize <= 0 && ExportSize <= 211 && NumberOfSections > 2 && ImageVersion > 1000 && ResourceSize <= 12996)
            fStatus = 1;
        else if(DebugSize <= 0 && ExportSize <= 211 && NumberOfSections > 2 && ResourceSize > 0 && VirtualSize2 > 1016)
            fStatus = 1;
        else if(NumberOfSections > 8 && VirtualSize2 <= 2221)
            fStatus = 1;
        else if(ResourceSize <= 736 && NumberOfSections <= 3)
            fStatus = 1;
        else if(NumberOfSections <= 3 && IatRVA > 4156)
            fStatus = 0;
        else if(ImageVersion <= 6000 && ResourceSize <= 523 && IatRVA > 0 && ExportSize <= 95)
            fStatus = 1;
        else if(ExportSize <= 256176 && DebugSize > 0 && ImageVersion <= 5450 && IatRVA > 1664 && ResourceSize <= 2040 && DebugSize <= 41)
            fStatus = 0;
        else if(ExportSize <= 256176 && ImageVersion > 5450)
            fStatus = 0;
        else if(ExportSize > 256176)
            fStatus = 1;
        else if(ImageVersion > 0 && ResourceSize > 298216 && IatRVA <= 2048)
            fStatus = 1;
        else if(ImageVersion > 0 && ExportSize > 74 && DebugSize > 0)
            fStatus = 0;
        else if(ImageVersion > 0 && VirtualSize2 > 4185 && ResourceSize <= 215376 && IatRVA <= 2048 && NumberOfSections <= 5)
            fStatus = 0;
        else if(ImageVersion > 1010 && DebugSize <= 56 && VirtualSize2 <= 215376)
            fStatus = 0;
        else if(ExportSize > 258 && NumberOfSections > 3 && DebugSize > 0)
            fStatus = 0;
        else if(ExportSize > 262 && ImageVersion > 0 && NumberOfSections > 7)
            fStatus = 0;
        else if(DebugSize > 41 && NumberOfSections <= 4)
            fStatus = 0;
        else if(ExportSize <= 262 && NumberOfSections > 3 && VirtualSize2 <= 37)
            fStatus = 1;
        else if(VirtualSize2 > 40 && ExportSize <= 262 && DebugSize <= 0 && ImageVersion <= 353 && ExportSize <= 142)
            fStatus = 1;
        else if(VirtualSize2 > 72384 && VirtualSize2 <= 263848)
            fStatus = 1;
        else if(IatRVA > 106496 && IatRVA <= 937984 && DebugSize > 0 && ResourceSize > 4358)
            fStatus = 0;
        else if(VirtualSize2 <= 64 && IatRVA <= 2048 && DebugSize <= 0 && ImageVersion <= 353 && ExportSize <= 0 && VirtualSize2 <= 4 && NumberOfSections <= 2)
            fStatus = 0;
        else if(DebugSize <= 0 && NumberOfSections <= 4 && IatRVA > 45548)
            fStatus = 1;
        else if(DebugSize > 0 && DebugSize <= 56 && IatRVA <= 94208 && ResourceSize <= 4096)
            fStatus = 1;
        else if(DebugSize <= 0 && IatRVA <= 98304 && NumberOfSections > 6 && ResourceSize <= 864 && ExportSize > 74 && ImageVersion > 353 && ExportSize <= 279)
            fStatus = 0;
        else if(DebugSize <= 0 && IatRVA <= 98304 && NumberOfSections <= 2 && ResourceSize <= 1264128)
            fStatus = 1;
        else if(VirtualSize2 <= 64 && IatRVA <= 2048 && DebugSize > 0)
            fStatus = 0;
        else if(ExportSize <= 276 && NumberOfSections > 5 && ResourceSize <= 1076)
            fStatus = 0;
        else if(DebugSize > 0 && IatRVA <= 94208 && ExportSize <= 82 && DebugSize <= 56 && NumberOfSections > 2 && ImageVersion <= 2340 && ResourceSize <= 118280 && VirtualSize2 > 5340)
            fStatus = 0;
        else if(DebugSize > 0 && ImageVersion <= 2340 && DebugSize <= 56 && NumberOfSections > 3 && VirtualSize2 > 360 && NumberOfSections <= 5)
            fStatus = 1;
        else if(IatRVA > 37380 && ImageVersion <= 0 && NumberOfSections <= 5 && VirtualSize2 > 15864)
            fStatus = 0;
        else if(DebugSize <= 0 && VirtualSize2 <= 80 && IatRVA <= 4096 && ExportSize <= 0 && VirtualSize2 > 4 && VirtualSize2 <= 21)
            fStatus = 0;
        else if(DebugSize <= 0)
            fStatus = 1;
        else if(ExportSize <= 82 && DebugSize <= 56 && NumberOfSections <= 5 && NumberOfSections > 2 && IatRVA <= 6144 && ImageVersion > 2340)
            fStatus = 0;
        else if(ImageVersion > 2340)
            fStatus = 1;
        else if(ResourceSize > 5528)
            fStatus = 0;
        else
            fStatus = 1;
    }
    
    return fStatus;
}

int runJ48(char *file)
{
	int fStatus = 0;
	
	struct pe_file pf;
	memset(&pf, 0, sizeof(pf));
	
    if(!read_pe(file, &pf)) {
        
        if(pf.NtHeaders.OptionalHeader.DataDirectory[6].Size <= 0)
            if(pf.NtHeaders.OptionalHeader.DataDirectory[0].Size <= 211)
                if((pf.NtHeaders.OptionalHeader.MajorImageVersion * 100 + pf.NtHeaders.OptionalHeader.MinorImageVersion) * 1000L <= 520)
                    if(pf.EPSections[1].Misc.VirtualSize <= 130)
                        if(pf.EPSections[1].Misc.VirtualSize <= 5)
                            if(pf.NtHeaders.OptionalHeader.DataDirectory[2].Size <= 37520)
                                fStatus = 1;
                            else
                                if(pf.NtHeaders.FileHeader.NumberOfSections <= 2)
                                    if(pf.NtHeaders.OptionalHeader.DataDirectory[1].VirtualAddress <= 2048)
                                        fStatus = 0;
                                    else
                                        fStatus = 1;
                                else
                                    fStatus = 1;
                        else
                            if(pf.EPSections[1].Misc.VirtualSize <= 12)
                                if(pf.NtHeaders.FileHeader.NumberOfSections <= 3)
                                    fStatus = 0;
                                else
                                    fStatus = 1;
                            else
                                fStatus = 1;
                    else
                        fStatus = 1;
                else
                    if(pf.NtHeaders.OptionalHeader.DataDirectory[2].Size <= 0)
                        if((pf.NtHeaders.OptionalHeader.MajorImageVersion * 100 + pf.NtHeaders.OptionalHeader.MinorImageVersion) * 1000L <= 1000)
                            if(pf.NtHeaders.FileHeader.NumberOfSections <= 4)
                                fStatus = 1;
                            else
                                if(pf.NtHeaders.OptionalHeader.DataDirectory[0].Size <= 74)
                                    if(pf.EPSections[1].Misc.VirtualSize <= 1556)
                                        fStatus = 1;
                                    else
                                        fStatus = 0;
                                else
                                    fStatus = 0;
                        else
                            fStatus = 1;
                    else
                        if(pf.NtHeaders.FileHeader.NumberOfSections <= 2)
                            if((pf.NtHeaders.OptionalHeader.MajorImageVersion * 100 + pf.NtHeaders.OptionalHeader.MinorImageVersion) * 1000L <= 3420)
                                fStatus = 1;
                            else
                                fStatus = 0;
                        else
                            fStatus = 1;
            else
                if((pf.NtHeaders.OptionalHeader.MajorImageVersion * 100 + pf.NtHeaders.OptionalHeader.MinorImageVersion) * 1000L <= 0)
                    if(pf.NtHeaders.OptionalHeader.DataDirectory[0].Size <= 23330)
                        if(pf.NtHeaders.OptionalHeader.DataDirectory[1].VirtualAddress <= 98304)
                            if(pf.NtHeaders.FileHeader.NumberOfSections <= 3)
                                fStatus = 1;
                            else
                                if(pf.NtHeaders.OptionalHeader.DataDirectory[1].VirtualAddress <= 53872)
                                    fStatus = 0;
                                else
                                    if(pf.NtHeaders.OptionalHeader.DataDirectory[0].Size <= 273)
                                        fStatus = 1;
                                    else
                                        if(pf.NtHeaders.OptionalHeader.DataDirectory[2].Size <= 1016)
                                            fStatus = 1;
                                        else
                                            fStatus = 0;
                        else
                            fStatus = 0;
                        
                    else
                        fStatus = 1;
                    
                else
                    fStatus = 0;
        else
            if(pf.NtHeaders.OptionalHeader.DataDirectory[2].Size <= 545)
                if(pf.NtHeaders.OptionalHeader.DataDirectory[0].Size <= 92)
                    if(pf.NtHeaders.FileHeader.NumberOfSections <= 4)
                        fStatus = 0;
                    else
                        fStatus = 1;
            else
                if(pf.NtHeaders.OptionalHeader.DataDirectory[1].VirtualAddress <= 94208)
                    if(pf.NtHeaders.FileHeader.NumberOfSections <= 5)
                        if(pf.NtHeaders.OptionalHeader.DataDirectory[0].Size <= 0)
                            if(pf.NtHeaders.FileHeader.NumberOfSections <= 4)
                                if(pf.NtHeaders.OptionalHeader.DataDirectory[1].VirtualAddress <= 13504)
                                    if((pf.NtHeaders.OptionalHeader.MajorImageVersion * 100 + pf.NtHeaders.OptionalHeader.MinorImageVersion) * 1000L <= 353)
                                        if(pf.NtHeaders.FileHeader.NumberOfSections <= 3)
                                            if(pf.NtHeaders.OptionalHeader.DataDirectory[1].VirtualAddress <= 6144)
                                                if(pf.NtHeaders.OptionalHeader.DataDirectory[1].VirtualAddress <= 2048)
                                                    fStatus = 0;
                                                else
                                                    if(pf.EPSections[1].Misc.VirtualSize <= 496)
                                                        fStatus = 1;
                                                    else
                                                        fStatus = 0;
                                            else
                                                if(pf.NtHeaders.OptionalHeader.DataDirectory[6].Size <= 41)
                                                    if(pf.NtHeaders.OptionalHeader.DataDirectory[2].Size <= 22720)
                                                        fStatus = 1;
                                                    else
                                                        fStatus = 0;
                                                else
                                                    fStatus = 0;
                                    else
                                        fStatus = 0;
                                else
                                    if(pf.NtHeaders.OptionalHeader.DataDirectory[2].Size <= 35328)
                                        fStatus = 0;
                                    else
                                        fStatus = 1;
                            else
                                if(pf.NtHeaders.OptionalHeader.DataDirectory[1].VirtualAddress <= 2048)
                                    fStatus = 1;
                                else
                                    fStatus = 0;
                        else
                            fStatus = 0;
                    else
                        if(pf.NtHeaders.OptionalHeader.DataDirectory[1].VirtualAddress <= 1054)
                            if(pf.NtHeaders.OptionalHeader.DataDirectory[0].Size <= 218)
                                if(pf.NtHeaders.OptionalHeader.DataDirectory[1].VirtualAddress <= 704)
                                    fStatus = 1;
                                else
                                    if(pf.NtHeaders.FileHeader.NumberOfSections <= 6)
                                        fStatus = 1;
                                    else
                                        fStatus = 0;
                            else
                                fStatus = 0;
                        else
                            fStatus = 0;
                else
                    if(pf.NtHeaders.OptionalHeader.DataDirectory[0].Size <= 0)
                        if(pf.EPSections[1].Misc.VirtualSize <= 78800)
                            if(pf.NtHeaders.FileHeader.NumberOfSections <= 4)
                                fStatus = 0;
                            else
                                if((pf.NtHeaders.OptionalHeader.MajorImageVersion * 100 + pf.NtHeaders.OptionalHeader.MinorImageVersion) * 1000L <= 2340)
                                    if(pf.NtHeaders.OptionalHeader.DataDirectory[2].Size <= 7328)
                                        fStatus = 1;
                                    else
                                        fStatus = 0;
                        else
                            fStatus = 1;
                    else
                        if(pf.NtHeaders.OptionalHeader.DataDirectory[1].VirtualAddress <= 106496)
                            if(pf.NtHeaders.OptionalHeader.DataDirectory[2].Size <= 2800)
                                fStatus = 0;
                            else
                                fStatus = 1;
                        else
                            fStatus = 0;
    }
    
    return fStatus;
}

int runJ48Graft(char *file)
{
    int fStatus = 0;
    
	struct pe_file pf;
	memset(&pf, 0, sizeof(pf));
	
    if(!read_pe(file, &pf)) {
    	DWORD DebugSize = pf.NtHeaders.OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_DEBUG].Size;
        int ImageVersion = (pf.NtHeaders.OptionalHeader.MajorImageVersion * 100 + pf.NtHeaders.OptionalHeader.MinorImageVersion) * 1000L;
        DWORD IatRVA = pf.NtHeaders.OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_IMPORT].VirtualAddress;
        DWORD ExportSize = pf.NtHeaders.OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].Size;
        DWORD ResourceSize = pf.NtHeaders.OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_RESOURCE].Size;
        DWORD VirtualSize2 = pf.EPSections[1].Misc.VirtualSize;
        WORD NumberOfSections = pf.NtHeaders.FileHeader.NumberOfSections;
        
        if(DebugSize <= 0)
            if(ExportSize <= 211)
                if(ImageVersion <= 520)
                    if(VirtualSize2 <= 130)
                        if(VirtualSize2 <= 5)
                            if(ResourceSize <= 37520)
                                fStatus = 1;
                            else if(ResourceSize > 37520)
                                if(NumberOfSections <= 2)
                                    if(IatRVA <= 2048)
                                        if(ExportSize <= 67.5)
                                            fStatus = 0;
                                        else
                                            fStatus = 1;
                                    else
                                        fStatus = 1;
                                else
                                    fStatus = 1;
                        else
                            if(VirtualSize2 <= 12)
                                if(NumberOfSections <= 3)
                                    fStatus = 0;
                                else
                                    fStatus = 1;
                            else
                                fStatus = 1;
                    else
                        fStatus = 1;
                else
                    if(ResourceSize <= 0)
                        if(ImageVersion <= 1000)
                            if(NumberOfSections <= 4)
                                fStatus = 1;
                            else
                                if(ExportSize <= 74)
                                    if(VirtualSize2 <= 1556)
                                        fStatus = 1;
                                    else
                                        if(IatRVA <= 5440)
                                            if(VirtualSize2 <= 126474)
                                                if(ExportSize <= 24)
                                                    fStatus = 0;
                                                else
                                                    fStatus = 1;
                                            else
                                                fStatus = 1;
                                        else
                                            fStatus = 1;
                                else
                                    fStatus = 0;
                        else
                            fStatus = 1;
                    else
                        if(NumberOfSections <= 2)
                            if(ImageVersion <= 3420)
                                fStatus = 1;
                            else
                                fStatus = 0;
                        else
                            fStatus = 1;
            else
                if(ImageVersion <= 0)
                    if(ExportSize <= 23330)
                        if(IatRVA <= 98304)
                            if(NumberOfSections <= 3)
                                fStatus = 1;
                            else
                                if(IatRVA <= 53872)
                                    if(VirtualSize2 <= 17.5)
                                        fStatus = 1;
                                    else
                                        if(NumberOfSections <= 10.5)
                                            if(ResourceSize <= 3103192)
                                                if(ExportSize <= 10858.5)
                                                    if(VirtualSize2 <= 116016.5)
                                                        fStatus = 0;
                                                    else
                                                        fStatus = 1;
                                                else
                                                    fStatus = 0;
                                            else
                                                fStatus = 1;
                                        else
                                            fStatus = 1;
                                else
                                    if(ExportSize <= 273)
                                        fStatus = 1;
                                    else
                                        if(ResourceSize <= 1016)
                                            fStatus = 1;
                                        else
                                            fStatus = 0;
                        else
                            fStatus = 0;
                    else
                        fStatus = 1;
                else
                    if(ExportSize <= 1006718985)
                        fStatus = 0;
                    else
                        fStatus = 1;
        else
            if(ResourceSize <= 545)
                if(ExportSize <= 92)
                    if(NumberOfSections <= 4)
                        fStatus = 0;
                    else
                        if(ImageVersion <= 6005)
                            if(ExportSize <= 6714)
                                fStatus = 1;
                            else
                                fStatus = 0;
                        else
                            fStatus = 0;
            else
                if(IatRVA <= 94208)
                    if(NumberOfSections <= 5)
                        if(ExportSize <= 0)
                            if(NumberOfSections <= 4)
                                if(IatRVA <= 13504)
                                    if(ImageVersion <= 353)
                                        if(NumberOfSections <= 3)
                                            if(IatRVA <= 6144)
                                                if(IatRVA <= 2048)
                                                    if(ResourceSize <= 934)
                                                        fStatus = 1;
                                                    else
                                                        if(VirtualSize2 <= 2728)
                                                            fStatus = 0;
                                                        else
                                                            fStatus = 1;
                                                else
                                                    if(VirtualSize2 <= 496)
                                                        fStatus = 1;
                                                    else
                                                        fStatus = 0;
                                            else
                                                fStatus = 0;
                                        else
                                            if(DebugSize <= 41)
                                                if(ResourceSize <= 22720)
                                                    if(IatRVA <= 2048)
                                                        fStatus = 1;
                                                    else
                                                        if(VirtualSize2 <= 46)
                                                            fStatus = 0;
                                                        else
                                                            fStatus = 1;
                                                else
                                                        if(VirtualSize2 <= 43030)
                                                            if(ResourceSize <= 3898348)
                                                                if(IatRVA <= 2048)
                                                                    fStatus = 1;
                                                                else
                                                                    fStatus = 0;
                                                            else
                                                                fStatus = 1;
                                                        else
                                                            fStatus = 0;
                                            else
                                                fStatus = 0;
                                    else
                                        fStatus = 0;
                                else
                                    if(ResourceSize <= 35328)
                                        if(ImageVersion <= 4005)
                                            if(NumberOfSections <= 1.5)
                                                fStatus = 1;
                                            else
                                                fStatus = 0;
                                        else
                                            fStatus = 0;
                                    else
                                        if(ImageVersion <= 5510)
                                            if(DebugSize <= 42)
                                                if(VirtualSize2 <= 144328)
                                                    if(NumberOfSections <= 3.5)
                                                        fStatus = 0;
                                                    else
                                                        fStatus = 1;
                                                else
                                                    fStatus = 0;
                                            else
                                                fStatus = 0;
                                        else
                                            fStatus = 0;
                            else
                                if(IatRVA <= 2048)
                                    fStatus = 1;
                                else
                                    fStatus = 0;
                        else
                            fStatus = 0;
                    else
                        if(IatRVA <= 1054)
                            if(ExportSize <= 218)
                                if(IatRVA <= 704)
                                    fStatus = 1;
                                else
                                    if(NumberOfSections <= 6)
                                        fStatus = 1;
                                    else
                                        fStatus = 0;
                            else
                                if(ExportSize <= 1006699445)
                                    if(ImageVersion <= 5510)
                                        if(ImageVersion <= 500)
                                            fStatus = 1;
                                        else
                                            fStatus = 0;
                                    else
                                        fStatus = 0;
                                else
                                    fStatus = 1;
                        else
                            fStatus = 0;
                else
                    if(ExportSize <= 0)
                        if(VirtualSize2 <= 78800)
                            if(NumberOfSections <= 4)
                                fStatus = 0;
                            else
                                if(ImageVersion <= 2340)
                                    if(ResourceSize <= 7328)
                                        fStatus = 1;
                                    else
                                        if(VirtualSize2 <= 8288.5)
                                            fStatus = 1;
                                        else
                                            if(NumberOfSections <= 6.5)
                                                fStatus = 0;
                                            else
                                                fStatus = 1;
                                else
                                    fStatus = 0;
                        else
                            if(ImageVersion <= 5515)
                                fStatus = 1;
                            else
                                fStatus = 0;
                    else
                        if(IatRVA <= 106496)
                            if(ResourceSize <= 2800)
                                fStatus = 0;
                            else
                                if(ImageVersion <= 500)
                                    if(ResourceSize <= 5360)
                                        if(NumberOfSections <= 4.5)
                                            fStatus = 0;
                                        else
                                            if(VirtualSize2 <= 22564.5)
                                                if(ExportSize <= 191.5)
                                                    if(DebugSize <= 42)
                                                        if(ExportSize <= 162.5)
                                                            fStatus = 0;
                                                        else
                                                            if(VirtualSize2 <= 10682)
                                                                fStatus = 0;
                                                            else
                                                                if(ResourceSize <= 3412)
                                                                    fStatus = 0;
                                                                else
                                                                    fStatus = 1;
                                                    else
                                                        fStatus = 0;
                                                else
                                                    fStatus = 0;
                                            else
                                                fStatus = 0;
                                    else
                                        fStatus = 0;
                                else
                                    fStatus = 0;
                        else
                            fStatus = 0;
    }
    
    return fStatus;
}

int runRidor(char *file)
{
    int fStatus = 0;
    
	struct pe_file pf;
	memset(&pf, 0, sizeof(pf));
	
    if(!read_pe(file, &pf)) {
    	DWORD DebugSize = pf.NtHeaders.OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_DEBUG].Size;
        int ImageVersion = (pf.NtHeaders.OptionalHeader.MajorImageVersion * 100 + pf.NtHeaders.OptionalHeader.MinorImageVersion) * 1000L;
        DWORD IatRVA = pf.NtHeaders.OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_IMPORT].VirtualAddress;
        DWORD ExportSize = pf.NtHeaders.OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].Size;
        DWORD ResourceSize = pf.NtHeaders.OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_RESOURCE].Size;
        DWORD VirtualSize2 = pf.EPSections[1].Misc.VirtualSize;
        WORD NumberOfSections = pf.NtHeaders.FileHeader.NumberOfSections;
        
        if(DebugSize <= 14 && ImageVersion <= 760 && VirtualSize2 > 992 && ExportSize <= 80.5)
            fStatus = 1;
        else if(DebugSize <= 14 && ImageVersion <= 4525 && ExportSize <= 198.5 && ResourceSize <= 7348 && VirtualSize2 <= 6 && ResourceSize > 1773)
            fStatus = 1;
        else if(DebugSize <= 14 && ImageVersion <= 4950 && ExportSize <= 56 && IatRVA > 256 && VirtualSize2 > 42 && NumberOfSections > 3.5)
            fStatus = 1;
        else if(DebugSize <= 14 && ImageVersion <= 4950 && VirtualSize2 <= 6 && ResourceSize > 17302)
            fStatus = 1;
        else if(DebugSize <= 14 && NumberOfSections >= 2.5 && ResourceSize <= 1776 && IatRVA <= 6144 && ExportSize <= 219.5 && VirtualSize2 > 2410 && VirtualSize2 <= 61224)
            fStatus = 1;
        else if(DebugSize <= 14 && NumberOfSections >= 2.5 && ExportSize <= 198 && ResourceSize > 8 && VirtualSize2 > 83 && ResourceSize <= 976)
            fStatus = 1;
        else if(DebugSize <= 14 && NumberOfSections >= 2.5 && ResourceSize > 1418 && IatRVA > 6144 && VirtualSize2 <= 4)
            fStatus = 1;
        else if(DebugSize <= 14 && VirtualSize2 > 14 && NumberOfSections > 4.5 && ResourceSize > 1550 && VirtualSize2 <= 2398)
            fStatus = 1;
        else if(DebugSize <= 14 && VirtualSize2 > 14 && NumberOfSections > 4.5 && ExportSize > 138.5 && ImageVersion > 1005)
            fStatus = 1;
        else if(ImageVersion <= 5005 && DebugSize <= 14 && VirtualSize2 > 14 && NumberOfSections <= 4.5)
            fStatus = 1;
        else if(ImageVersion <= 5005 && DebugSize <= 14 && ImageVersion <= 5 && NumberOfSections > 3.5 && ExportSize <= 164.5 && IatRVA <= 73728 && ResourceSize <= 8722)
            fStatus = 1;
        else if(ImageVersion <= 5005 && DebugSize <= 14 && ResourceSize > 21108 && ResourceSize <= 37272 && ImageVersion <= 760)
            fStatus = 1;
        else if(NumberOfSections > 4.5 && ExportSize <= 25.5 && ImageVersion > 1505 && ResourceSize <= 1020)
            fStatus = 1;
        else if(ImageVersion <= 1500 && NumberOfSections > 5.5 && ExportSize <= 101 && ResourceSize <= 3168)
            fStatus = 1;
        else if(ImageVersion <= 3025 && DebugSize <= 14 && ResourceSize > 1182 && VirtualSize2 > 164 && ExportSize <= 330.5)
            fStatus = 1;
        else if(ImageVersion <= 1010 && ResourceSize > 2352 && VirtualSize2 > 115254 && VirtualSize2 <= 153258)
            fStatus = 1;
        else if(ImageVersion <= 1500 && NumberOfSections > 5.5 && ImageVersion <= 500 && ExportSize <= 164 && IatRVA <= 2048)
            fStatus = 1;
        else if(ImageVersion <= 1010 && ResourceSize <= 474 && IatRVA > 26624 && VirtualSize2 > 1802 && IatRVA <= 221348)
            fStatus = 1;
        else if(ImageVersion <= 2500 && DebugSize <= 14 && ResourceSize > 78678 && ResourceSize <= 120928 && NumberOfSections <= 4)
            fStatus = 1;
        else if(ImageVersion <= 5005 && ExportSize <= 25.5 && NumberOfSections > 3.5 && ResourceSize > 35814 && VirtualSize2 > 215352)
            fStatus = 1;
        else if(ImageVersion <= 500 && IatRVA <= 2560 && NumberOfSections > 3.5 && ResourceSize > 648 && ResourceSize <= 62291)
            fStatus = 1;
        else if(ExportSize <= 25.5 && NumberOfSections > 4.5 && VirtualSize2 > 50765 && ResourceSize <= 741012 && ResourceSize > 2512)
            fStatus = 1;
        else if(ImageVersion <= 1010 && ExportSize <= 25.5 && VirtualSize2 <= 3278 && VirtualSize2 > 1200 && ResourceSize > 2032)
            fStatus = 1;
        else if(ResourceSize <= 474 && ExportSize <= 76 && VirtualSize2 <= 1556 && IatRVA <= 2368)
            fStatus = 1;
        else if(ImageVersion <= 1500 && VirtualSize2 <= 6 && IatRVA > 2048)
            fStatus = 1;
        else
            fStatus = 0;
    }
    
    return fStatus;
}

int runAll(char *file)
{
	int a = runPART(file), b = runJ48(file), c = runJ48Graft(file), d = runRidor(file);
	
	if(a && b && c && d)
		return 1;
	else if(a || b || c || d)
		return 2;
	else
		return 0;
}
